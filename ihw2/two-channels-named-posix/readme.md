# Отчёт для программы: 9 баллов. Множество процессов взаимодействуют через каналы с использованием именованных POSIX семафоров.

## Код программы

Файл программы с логикой проведения соревнования - [fight-manager.cpp](fight-manager.cpp)

Файл программы с логикой вывода информации о поединках - [battle-viewer.cpp](battle-viewer.cpp)

## Описание входных данных

В терминале пользователю предлагается ввести энергию Ций каждого из бойцов, после чего начинается соревнование

## Описание алгоритма работы программы

- Сначала создается именованный канал `FIGHT_CHANNEL`, который будет использоваться для взаимодействия между программами.
- Бои начинаются параллельно для первых трех пар бойцов с использованием каналов. Каждый канал отвечает за один бой.
- После проведения трех боев проверяется, есть ли победитель в каждой паре. Если есть, происходит запись победителей в канал `FIGHT_CHANNEL`. Основной же поток ожидает завершения всех потоков боев и считывает результаты боев из канала `FIGHT_CHANNEL`.
- Проводится финальный бой между победителями первых трех боев.
  
## Описание кода программы

Сначала создается именованный канал `FIGHT_CHANNEL`, который будет использоваться в программе далее.
```cpp
//...
const char* FIGHT_CHANNEL = "/tmp/fight_channel";
mkfifo(FIGHT_CHANNEL, 0666);
//...
```

Запускается три потока `fights`, каждый из которых отвечает за проведение одного боя.
```cpp
sem_t* semaphore;
semaphore = sem_open(SEMAPHORE_NAME, O_CREAT, 0666, 0);

std::thread fights[3];
for (int i = 0; i < 3; ++i) {
    fights[i] = std::thread(fight, std::ref(fighters[i * 2]), std::ref(fighters[i * 2 + 1]), semaphore);
}
```

Вторая программа открывает именованный канал `FIGHT_CHANNEL` для чтения результатов боев.
```cpp
//...
int fd = open(FIGHT_CHANNEL, O_RDONLY);
//...
```

Далее считываются индексы победителей из именованного канала и выводит информацию о боях на экран.
```cpp
int fighterIndex;
while (read(fd, &fighterIndex, sizeof(int)) > 0) {
    std::cout << "Победитель боя: Боец " << fighterIndex + 1 << std::endl;
}
```

В конце программы происходит закрытие именованного канала после того, как все результаты боев были считаны и выведены на экран.
```cpp
//...
close(fd);
```
